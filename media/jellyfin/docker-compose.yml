
name: jellyfin

services:
  jellyfin-server:
    container_name: jellyfin
    image: nyanmisaka/jellyfin:latest     # nyanmisaka/jellyfin | jellyfin/jellyfin | linuxserver/jellyfin
    devices:
      - /dev/dri:/dev/dri
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - HTTP_PROXY=${PROXY_HOST}
      - HTTPS_PROXY=${PROXY_HOST}
      - APP_CMD=/jellyfin/jellyfin
    volumes:
      - ${DATA_PATH}:/data
      - ${CONFIG_PATH}:/config
      - ${CACHE_PATH}:/cache
      - /mnt/nas/films:/media/films
      - ${MOUNT_PROBES_DIR}:/var/run/mount-probes:ro
      - ${MOUNT_SCRIPTS}:/usr/local/bin/wait-for-mount.sh:ro
      - ${ENTRYPOINT_SCRIPTS}:/usr/local/bin/entrypoint-mount.sh:ro
    env_file:
      - .env
    entrypoint: ["/usr/local/bin/entrypoint-mount.sh"]
    ports:
      - 8096:8096
    privileged: true
    hostname: jellyfin
    networks:
      - local_network
    restart: always
      
networks:
  local_network:
    external: true
